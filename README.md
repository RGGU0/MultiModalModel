# MultiModalModel

В данном репозитории размещены файлы, полученные при выполнении проекта по разработке мультимодальной искусственной нейронной сети промежуточного слияния для бинарной классификации легких.

Классификация производится по двум классам: lung (заболевание легких) и normal(клиническая норма).

Набор данных имеет две модальности: модальность ренгенологических снимков (изображение) и клинических данных (текст).
## Разработка была разделена на этапы:
### 1. Предобработка

Проводилась проверка влияния сегментации легких на рентгенологических снимках обучающего набора на результат последующей классификации.
Для обработки набора были протестированы две модели (файлы FirstSegmentationModel.ipynb и second_model_segmentation.ipynb).
Итоговая обработка производилась второй моделью для сегментации.

![image](https://github.com/RGGU0/MultiModalModel/assets/89143056/397fec23-0d7d-4ef4-a9e0-555450b9271a)

### 2. Реализация одномодальных сетей

Были созданы две одномодальные сети, по одной на модальность.

В основе модели классификации рентгенологических снимков (файл ImgModel.ipynb) лежит предобученая модель vit-base-patch16-224-in2.

В основе модели классификации клинических данных (файл Text_model.ipynb) лежит предобученая модель bert-base-uncased.
### 3. Создание мультимодальной сети

Создана мультимодальная сеть с промежуточным слиянием модальностей.

Слияние производится путем взаимного обмена матрицами ключей и значений между блоками трансформеров.

![image](https://github.com/RGGU0/MultiModalModel/assets/89143056/660fc92d-d6d0-4485-ad67-7e129778ddd0)

## Результаты:
При измерении точности классификации максимальные значения, которые были получены: 77 процентов при классификации рентгенологических снимков, 88 – клинических данных, 79 – при классификации на основе обеих модальностей. Таким образом, лучшую точность показало применение модели классификации клинических данных.

| Accuracy [%]  | Модальность   |
| ------------- | ------------- |
| 77  | Рентгенологические снимки  |
| 88  | Клинические данные  |
| 79  | Рентгенологические снимки + клинические данные  |

Точность мультимодальной модели оказалась выше модели классификации снимков, но ниже модели клинических данных. Что можно объяснить тем, что ее результат является промежуточным между двумя другими моделями. Поскольку точность одномодальных моделей отличается почти на 10 процентов, вместо взаимной корректировки, в данном случае, имел место обратный эффект. Менее качественная модель внесла помехи в предсказания более успешной.
